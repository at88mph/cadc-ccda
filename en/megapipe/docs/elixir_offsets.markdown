---
layout: cadc
lang: en
permalink: /en/megapipe/docs/elixphot.html
title: Elixir Photometric Offsets
altLangPage: /fr/megapipe/docs/elixphot.html
dateModified: 2021-12-08
signing: layout.signing
nositesearch: layout.nositesearch
nav: megapipe
breadcrumbs:
    - link: /en/megapipe/
      title: MegaPipe
    - link: /en/megapipe/docs/proc.html
      title: Stacking Procedure
    - link: /en/megapipe/docs/elixphot.html
      title: Elixir Photometric Offsets
---

<h2>Synopsis</h2>
<p>
    This page describes the comparison of the photometric zero-points
    generated by Elixir for MegaCam data with those computed
    using the SDSS as a reference.
    Two types of photometric offsets are studied.
    The first  (the differential zero-point offsets)
    are the differences in photometric zero-point 
    between different CCDs in the same image.
    The second (the absolute zero-point offsets)
    is the difference between the average zero-point
    of an image as determined from the SDSS and that 
    determined by Elixir.
</p>
<p>
    It is found that,
    for the most part, the differential zero-point offsets are on the 
    order of 0.03 mags, but significant outliers exist.
    The absolute zero=points are fairly stable, for
    most bands, but offsets of up to 0.2 mags exist
    for the <em>u</em>-band.
    Tables of corrections are presented:
    one for the <a href="/static/files/megapipe/ElixirDiffCor">differential
    corrections</a> one for the <a href="/static/files/megapipe/ElixirAbsCor">absolute
    corrections</a>.
</p>
<h2>Background</h2>
<p>
    Before MegaCam data is run through MegaPipe, the data is
    preprocessed in Hawaii using the Elixir software package. Elixir
    provides image detrending and an initial astrometric
    calibration. It also provides a photometric calibration, based on
    standard stars taken each night, as described on
    the <a rel="external" href="https://www.cfht.hawaii.edu/Instruments/Imaging/MegaPrime/megaprimecalibration.html#P2">MegaPrime
    calibration page</a>. This photometric calibration is used as the
    basis of the MegaPipe photometric calibration, as
    discussed in the <a href="proc.html#photcal">Photometric calibration section</a>.
    of the MegaPipe stacking procedure.  
</p>
<h2>Differential zero-point offsets</h2>
<p>
    The differential offsets are the offsets between different CCDs of
    a single MegaCam image, regardless of whether the image was been
    taken under photometric or not. Ideally, the photometric
    zero-point should be the same across the MegaCam field. In
    practice, difference exist.
</p>
<p>
    To investigate the differential zero-point offsets, the MegaCam
    archive was searched for images matching the following criteria:
</p>
<ul>
  <li>
    Each image must have an exposure time greater than 60 secs
  </li>
  <li>
    Each image must lie within the SDSS
  </li>
  <li>
    No two images with the same CRUNID should lie with 0.3 degrees
    of each other. (This is to ensure that the isolated patches of bad
    SDSS photometry don't affect the final result).
  </li>
</ul>
<p>
    Each of the images was astrometrically calibrated using the standard
    MegaPipe pipeline. The photometric zero-points for computed separately
    for each CCD. The difference between the individual zero-points and
    average of all the zero-points was computed. Since the images where
    not necessarily taken under photometric conditions, the Elixir
    zero-point may or may not be valid, and therefore was ignored for this
    stage. The old i filter (I.MP9701) and the new i filter (I.MP9702) were
    treated separately.
</p>
<p>
    The resulting differential zero-point measurements were aggregated by
    filter and CRUNID. For each of the CCDs, a median photometric
    zero-point offset was computed for each of the filter/CRUNID
    combinations. The individual and median zero-point offsets were
    plotted up. In these plots the black lines show the individual
    zero-point offsets (SDSS-Elixir) as a function of CCD number. The
    superimposed red line shows the median zero-point offsets. There is
    clearly some scatter about the median, indicated by the black lines
    and by the error bars (1 sigma). Two examples are shown below. (Others
    can be found in this <a href="/static/files/megapipe/dphotpics.tar.gz">tarball</a>).
</p>
<p>
    In some cases, the CCD to CCD variations are small, as shown in the
    figure below, for the r band, CRUNID=03AM05. Here the typical offset
    is 0.01 mags with an extreme range of about 0.03 mags
</p>
<img class="img-responsive" src="/static/images/megapipe/D.R.MP9601.03AM05.gif" alt="Diffferential offsets for r, CRUNID=03AM05"/>
<p>
   In other cases, the CCD to CCD variations are quite large as
    shown in the figure below for the (new) i band,
    CRUNID=08AM05. Here the typical offset is about 0.03 mags with an
    extreme range of about 0.09 mags.
</p>
<img class="img-responsive" src="/static/images/megapipe/D.I.MP9702.08AM05.gif" alt="Diffferential offsets for i, CRUNID=08AM05"/>
<p>
     There is clearly considerable variation in the differential
     zero-point variations. Going through the plots sequentially, one
     sees definite changes over time. Further, at least in some cases,
     the amplitude of the offsets is large enough to warrant
     correction.
</p>
<p>
    A <a href="/static/files/megapipe/ElixirDiffCor">table of offsets</a> for all CRUNID from
    2003 to the present was produced. The first two columns are the
    filter and the CRUNID. The next 36 columns contain the zero-point
    corrections, which should be added to the Elixir zero-point for
    each CCD.
</p>
<p>
    The corrections were generated directly for CRUNIDs and filter
    combinations where there was enough data (more than 3 exposures
    per CRUNID/filter) to reliably do so. For the others, the
    corrections are interpolated between previous and subsequent
    CRUNIDs. Going the through the plots in
    the <a href="/static/files/megapipe/dphotpics.tar.gz">tarball</a> in sequence shows that
    the corrections change fairly slowly over time, indicating that
    the interpolation is a sensible thing to do. The plots in the
    tarball corresponding to interpolated corrections are labeled with
    "Interpolated" in blue. Again, when one views the plots in
    sequence, the plots marked interpolated do no seem egregious. In
    addition, there a few cases where there are some data for a
    filter/CRUNID combination, but not enough to reliably determine
    the offsets. That is to say, there are filter/CRUNID combinations
    with more than 0, but less than 3 exposures. In this cases, the
    interpolated offsets agree well with the few measured offsets.
</p>
<h2>Absolute zero-point offsets</h2>
<p>
    The next step is to measure the offsets of the MegaCam mosaic as a
    whole with respect to the SDSS. To measure this for a given image,
    one compares the Elixir zero-point determined from the header
    keywords to the zero-point determined by comparing the instrumental
    magnitudes of stars in the images to the magnitudes in the
    SDSS.  As before, the MegaCam archive was searched for all
    suitable images.  In this case, the criteria are slightly
    different. In order for the Elixir zero-point to be valid, the
    night must photometric.  Whether or not a given night was
    photometric was determined using the <a rel="external" href="https://www.cfht.hawaii.edu/Instruments/Elixir/skyprobe/home.html">SkyProbe</a>
    plots.  The patches of bad SDSS photometry are small (0.1 sq
    degrees at most) so the requirement that all the pointing must be
    different can be relaxed. The new criteria are then:
</p>
<ul>
  <li>
    Each image must have an exposure time greater than 60 secs
  </li>
  <li> 
    Each image must lie within the SDSS
  </li>
  <li> 
    The night must be photometric
  </li>
</ul>
<p>
    For each image, the average zero point difference over all the CCDs between the
    SDSS and Elixir zero-point was measured. SExtractor is run
    on the image with MAG_ZEROPOINT=0. The resulting catalog is
    astrometrically calibrated using the standard MegaPipe
    system. The relevant part of the SDSS catalogue is 
    retrieved from the <a rel="external" href="http://skyserver.sdss3.org/dr9/en/tools/search/">SDSS data server</a>.
    The SDSS magnitudes are converted to MegaCam magnitudes using 
    the transformations described on the
    <a href="filt.html">MegaCam ugriz filter set</a> page.
    The transformations are:
</p>
<pre>  
u_Mega = u_SDSS - 0.241 (u_SDSS - g_SDSS)
g_Mega = g_SDSS - 0.153 (g_SDSS - r_SDSS)
r_Mega = r_SDSS - 0.024 (g_SDSS - r_SDSS)
i_Mega = i_SDSS - 0.085 (r_SDSS - i_SDSS) (old)
i_Mega = i_SDSS - 0.003 (r_SDSS - i_SDSS) (new)
z_Mega = z_SDSS + 0.074 (i_SDSS - z_SDSS)
</pre>
<p>
    The image catalogue is matched to the SDSS catalogue. The
    difference between the instrumental magnitudes and the SDSS
    magnitudes yields the SDSS photometric zero-point. The Elixir
    zero-point is calculated from the header keywords as follows:
</p>
<p>
  ZP<sub>Elixir</sub> = PHOT_C + PHOT_K * (AIRMASS-1) + 2.5 * log10(EXPTIME)
</p>
<p>
    The differential offset described above were also applied to the
    Elixir zero-points. Note that because differential offsets average
    to 0 over the whole mosaic (by design), applying these offsets
    only reduces the scatter of the individual CCD zero-points about
    the average zero-point, but does not change the value of the
    average zero-point.
</p>
<p>
    The zero-point differences were then aggregated by filter and
    CRUNID. The median zero-point difference was computed as well as
    the standard deviation about this median. This is summarized in
    the <a href="/static/files/megapipe/ElixirAbsCor">table of absolute offsets</a>. For some
    filter/CRUNID combinations, no data was taken on photometric
    nights. For other combinations, data is available for multiple
    photometric nights during a single run. In a number of cases,
    there is variation in the zero-point difference between two
    apparently photometric nights of the same run. The zero-point
    differences may be stable within a single night, but there are
    difference from night to night. In addition, there are
    occasionally variations in the zero-point differences within a
    single night, indicating that the night was not photometric.
</p>
<p>
    The zero-point differences for the filter/CRUNID combinations
    were sorted into three categories, labeled "No_info", "Excellent",
    and "Marginal" in the table.
</p>
<ul>
  <li>
    <strong>No_info:</strong> No data was taken on photometric nights during this camera run with this filter.
  </li>
  <li>
    <strong>Excellent:</strong> Data was taken on a least two photometric nights during this camera run, and at least 6 images were taken on those nights, and the scatter about the median zero-point difference is less than 0.02 magnitudes. 
  </li>
  <li>
    <strong>Marginal:</strong> There is some data, but it doesn't meet the criteria outlined above. Either data was not taken on more than one night, or less than 6 images were taken, or the scatter is large. 
  </li>
</ul>
<p>
    The plots that follow show the zero-point history of MegaCam for
    the ugriz filters. The measurements are grouped by CRUNID, as
    indicated by a column on the left side of each plot. The earliest
    data is at the top. The "Excellent" cases are shown in red. The
    "Marginal" case are shown in black. The average offset is shown as
    a green line.
</p>
<p>
  Zero point history for the u-band. There is considerable
    variation, with some offsets as big as 0.25
    magnitudes.
</p>
<img class="img-responsive" src="/static/images/megapipe/ASUM.U.MP9301.gif" alt="Zero point history for the u-band"/>
<p>
    Zero point history for the g-band. Here the zero-point is much more stable.
</p>
<img class="img-responsive" src="/static/images/megapipe/ASUM.G.MP9401.gif" alt="Zero point history for the g-band"/>
<p>Zero point history for the r-band</p>
<img class="img-responsive" src="/static/images/megapipe/ASUM.R.MP9601.gif" alt="Zero point history for the r-band"/>
<p>Zero point history for the old i-band</p>
<img class="img-responsive" src="/static/images/megapipe/ASUM.I.MP9701.gif" alt="Zero point history for the old i-band"/>
<p>Zero point history for the new i-band</p>
<img class="img-responsive" src="/static/images/megapipe/ASUM.I.MP9702.gif" alt="Zero point history for the new i-band"/>
<p>Zero point history for the z-band</p>
<img class="img-responsive" src="/static/images/megapipe/ASUM.Z.MP9801.gif" alt="Zero point history for the z-band"/>
<p>
    Note that in all cases there is small but measurable difference
    between the SDSS zero-point and the Elixir zero-point.  For all the
    filters but <em>u</em>, using an single average zero-point correction
    may be acceptable.  These average zero-point corrections (which should
    be added to the Elixir zero-points) are as follows:
</p>
<pre>
U.MP9301    -0.031
G.MP9401     0.048
R.MP9601     0.036
I.MP9701     0.051
I.MP9702     0.028
Z.MP9801     0.094
</pre>
<p>
    The run-by-run scatter about the central offset is only about 0.03
    magnitudes, with few exceptions.  For the <em>u</em> filter, on the
    other hand, if one wishes to avoid zero-point errors of up 0.25
    magnitudes a correction must be applied to the Elixir zero-point. The
    values in the
    <a href="/static/files/megapipe/ElixirAbsCor">table of corrections</a>
    should be added to the Elixir zero-point.
</p>
